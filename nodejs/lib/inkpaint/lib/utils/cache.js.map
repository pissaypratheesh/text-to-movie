{"version":3,"file":"cache.js","names":["TextureCache","Object","create","BaseTextureCache","addToTextureCache","texture","id","textureCacheIds","indexOf","push","removeFromTextureCache","textureFromCache","index","splice","i","length","addToBaseTextureCache","baseTexture","removeFromBaseTextureCache","baseTextureFromCache","destroyAllTextureCache","key","destroy","deleteAllTextureCache","destroyAndCleanAllCache","destroyBaseTextureCache","destroyTextureCache"],"sources":["../../src/utils/cache.js"],"sourcesContent":["export const TextureCache = Object.create(null);\n\nexport const BaseTextureCache = Object.create(null);\n\nexport function addToTextureCache(texture, id) {\n  if (!id) return;\n\n  if (texture.textureCacheIds.indexOf(id) === -1)\n    texture.textureCacheIds.push(id);\n\n  TextureCache[id] = texture;\n}\n\nexport function removeFromTextureCache(texture) {\n  if (typeof texture === \"string\") {\n    const textureFromCache = TextureCache[texture];\n\n    if (textureFromCache) {\n      const index = textureFromCache.textureCacheIds.indexOf(texture);\n      if (index > -1) textureFromCache.textureCacheIds.splice(index, 1);\n\n      delete TextureCache[texture];\n      return textureFromCache;\n    }\n  } else if (texture && texture.textureCacheIds) {\n    for (let i = 0; i < texture.textureCacheIds.length; ++i) {\n      if (TextureCache[texture.textureCacheIds[i]] === texture) {\n        delete TextureCache[texture.textureCacheIds[i]];\n      }\n    }\n\n    texture.textureCacheIds.length = 0;\n    return texture;\n  }\n\n  return null;\n}\n\nexport function addToBaseTextureCache(baseTexture, id) {\n  if (!id) return;\n\n  if (baseTexture.textureCacheIds.indexOf(id) === -1) {\n    baseTexture.textureCacheIds.push(id);\n  }\n\n  BaseTextureCache[id] = baseTexture;\n}\n\nexport function removeFromBaseTextureCache(baseTexture) {\n  if (typeof baseTexture === \"string\") {\n    const baseTextureFromCache = BaseTextureCache[baseTexture];\n\n    if (baseTextureFromCache) {\n      const index = baseTextureFromCache.textureCacheIds.indexOf(baseTexture);\n\n      if (index > -1) {\n        baseTextureFromCache.textureCacheIds.splice(index, 1);\n      }\n\n      delete BaseTextureCache[baseTexture];\n      return baseTextureFromCache;\n    }\n  } else if (baseTexture && baseTexture.textureCacheIds) {\n    for (let i = 0; i < baseTexture.textureCacheIds.length; ++i) {\n      delete BaseTextureCache[baseTexture.textureCacheIds[i]];\n    }\n\n    baseTexture.textureCacheIds.length = 0;\n    return baseTexture;\n  }\n\n  return null;\n}\n\nexport function destroyAllTextureCache() {\n  let key;\n\n  for (key in TextureCache) {\n    TextureCache[key].destroy();\n  }\n\n  for (key in BaseTextureCache) {\n    BaseTextureCache[key].destroy();\n  }\n}\n\nexport function deleteAllTextureCache() {\n  let key;\n\n  for (key in TextureCache) {\n    delete TextureCache[key];\n  }\n\n  for (key in BaseTextureCache) {\n    delete BaseTextureCache[key];\n  }\n}\n\nexport function destroyAndCleanAllCache() {\n  destroyAllTextureCache();\n  deleteAllTextureCache();\n}\n\nexport function destroyBaseTextureCache(key) {\n  if (!BaseTextureCache[key]) return;\n  BaseTextureCache[key].destroy();\n  delete BaseTextureCache[key];\n}\n\nexport function destroyTextureCache(key) {\n  if (!TextureCache[key]) return;\n  TextureCache[key].destroy();\n  delete TextureCache[key];\n}\n"],"mappings":"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"}