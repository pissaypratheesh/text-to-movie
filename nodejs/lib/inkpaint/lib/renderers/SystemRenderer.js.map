{"version":3,"file":"SystemRenderer.js","names":["tempMatrix","Matrix","SystemRenderer","EventEmitter","constructor","system","options","arg2","arg3","Object","assign","width","height","settings","RENDER_OPTIONS","type","RENDERER_TYPE","UNKNOWN","screen","Rectangle","view","Doc","createElement","resolution","RESOLUTION","transparent","autoResize","blendModes","preserveDrawingBuffer","clearBeforeRender","roundPixels","_backgroundColor","_backgroundColorRgba","_backgroundColorString","backgroundColor","_tempDisplayObjectParent","Container","_lastObjectRendered","resize","screenWidth","screenHeight","style","destroy","removeView","parentNode","removeChild","value","hex2string","hex2rgb"],"sources":["../../src/renderers/SystemRenderer.js"],"sourcesContent":["import { hex2string, hex2rgb } from \"../utils\";\nimport { Matrix, Rectangle } from \"../math\";\nimport { RENDERER_TYPE } from \"../const\";\nimport EventEmitter from \"eventemitter3\";\nimport Doc from \"../polyfill/Doc\";\nimport settings from \"../settings\";\nimport Container from \"../display/Container\";\nimport RenderTexture from \"../textures/RenderTexture\";\nconst tempMatrix = new Matrix();\n\nexport default class SystemRenderer extends EventEmitter {\n  constructor(system, options, arg2, arg3) {\n    super();\n\n    if (typeof options === \"number\") {\n      options = Object.assign(\n        {\n          width: options,\n          height: arg2 || settings.RENDER_OPTIONS.height\n        },\n        arg3\n      );\n    }\n\n    options = Object.assign({}, settings.RENDER_OPTIONS, options);\n    this.options = options;\n    this.type = RENDERER_TYPE.UNKNOWN;\n    this.screen = new Rectangle(0, 0, options.width, options.height);\n    this.view = options.view || Doc.createElement(\"canvas\");\n    this.resolution = options.resolution || settings.RESOLUTION;\n    this.transparent = options.transparent;\n    this.autoResize = options.autoResize || false;\n    this.blendModes = null;\n    this.preserveDrawingBuffer = options.preserveDrawingBuffer;\n    this.clearBeforeRender = options.clearBeforeRender;\n    this.roundPixels = options.roundPixels;\n\n    this._backgroundColor = 0x000000;\n    this._backgroundColorRgba = [0, 0, 0, 0];\n    this._backgroundColorString = \"#000000\";\n\n    this.backgroundColor = options.backgroundColor || this._backgroundColor; // run bg color setter\n    this._tempDisplayObjectParent = new Container();\n    this._lastObjectRendered = this._tempDisplayObjectParent;\n  }\n\n  get width() {\n    return this.view.width;\n  }\n\n  get height() {\n    return this.view.height;\n  }\n\n  resize(screenWidth, screenHeight) {\n    this.screen.width = screenWidth;\n    this.screen.height = screenHeight;\n\n    this.view.width = screenWidth * this.resolution;\n    this.view.height = screenHeight * this.resolution;\n\n    if (this.autoResize) {\n      this.view.style.width = `${screenWidth}px`;\n      this.view.style.height = `${screenHeight}px`;\n    }\n  }\n\n  destroy(removeView) {\n    if (removeView && this.view.parentNode) {\n      this.view.parentNode.removeChild(this.view);\n    }\n\n    this.type = RENDERER_TYPE.UNKNOWN;\n    this.view = null;\n    this.screen = null;\n    this.resolution = 0;\n    this.transparent = false;\n    this.autoResize = false;\n    this.blendModes = null;\n    this.options = null;\n\n    this.preserveDrawingBuffer = false;\n    this.clearBeforeRender = false;\n    this.roundPixels = false;\n\n    this._backgroundColor = 0;\n    this._backgroundColorRgba = null;\n    this._backgroundColorString = null;\n\n    this._tempDisplayObjectParent = null;\n    this._lastObjectRendered = null;\n  }\n\n  get backgroundColor() {\n    return this._backgroundColor;\n  }\n\n  set backgroundColor(value) {\n    this._backgroundColor = value;\n    this._backgroundColorString = hex2string(value);\n    hex2rgb(value, this._backgroundColorRgba);\n  }\n}\n"],"mappings":"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"}