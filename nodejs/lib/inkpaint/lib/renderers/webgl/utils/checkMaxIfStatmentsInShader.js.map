{"version":3,"file":"checkMaxIfStatmentsInShader.js","names":["fragTemplate","join","checkMaxIfStatmentsInShader","maxIfs","gl","shader","createShader","FRAGMENT_SHADER","fragmentSrc","replace","generateIfTestSrc","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","src","i"],"sources":["../../../../src/renderers/webgl/utils/checkMaxIfStatmentsInShader.js"],"sourcesContent":["const fragTemplate = [\n  \"precision mediump float;\",\n  \"void main(void){\",\n  \"float test = 0.1;\",\n  \"%forloop%\",\n  \"gl_FragColor = vec4(0.0);\",\n  \"}\"\n].join(\"\\n\");\n\nexport default function checkMaxIfStatmentsInShader(maxIfs, gl) {\n  const shader = gl.createShader(gl.FRAGMENT_SHADER);\n\n  while (true) {\n    const fragmentSrc = fragTemplate.replace(\n      /%forloop%/gi,\n      generateIfTestSrc(maxIfs)\n    );\n\n    gl.shaderSource(shader, fragmentSrc);\n    gl.compileShader(shader);\n\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n      maxIfs = (maxIfs / 2) | 0;\n    } else {\n      break;\n    }\n  }\n\n  return maxIfs;\n}\n\nfunction generateIfTestSrc(maxIfs) {\n  let src = \"\";\n\n  for (let i = 0; i < maxIfs; ++i) {\n    if (i > 0) {\n      src += \"\\nelse \";\n    }\n\n    if (i < maxIfs - 1) {\n      src += `if(test == ${i}.0){}`;\n    }\n  }\n\n  return src;\n}\n"],"mappings":";;;;;;AAAA,IAAMA,YAAY,GAAG,CACnB,0BAA0B,EAC1B,kBAAkB,EAClB,mBAAmB,EACnB,WAAW,EACX,2BAA2B,EAC3B,GAAG,CACJ,CAACC,IAAI,CAAC,IAAI,CAAC;AAEG,SAASC,2BAA2B,CAACC,MAAM,EAAEC,EAAE,EAAE;EAC9D,IAAMC,MAAM,GAAGD,EAAE,CAACE,YAAY,CAACF,EAAE,CAACG,eAAe,CAAC;EAElD,OAAO,IAAI,EAAE;IACX,IAAMC,WAAW,GAAGR,YAAY,CAACS,OAAO,CACtC,aAAa,EACbC,iBAAiB,CAACP,MAAM,CAAC,CAC1B;IAEDC,EAAE,CAACO,YAAY,CAACN,MAAM,EAAEG,WAAW,CAAC;IACpCJ,EAAE,CAACQ,aAAa,CAACP,MAAM,CAAC;IAExB,IAAI,CAACD,EAAE,CAACS,kBAAkB,CAACR,MAAM,EAAED,EAAE,CAACU,cAAc,CAAC,EAAE;MACrDX,MAAM,GAAIA,MAAM,GAAG,CAAC,GAAI,CAAC;IAC3B,CAAC,MAAM;MACL;IACF;EACF;EAEA,OAAOA,MAAM;AACf;AAEA,SAASO,iBAAiB,CAACP,MAAM,EAAE;EACjC,IAAIY,GAAG,GAAG,EAAE;EAEZ,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGb,MAAM,EAAE,EAAEa,CAAC,EAAE;IAC/B,IAAIA,CAAC,GAAG,CAAC,EAAE;MACTD,GAAG,IAAI,SAAS;IAClB;IAEA,IAAIC,CAAC,GAAGb,MAAM,GAAG,CAAC,EAAE;MAClBY,GAAG,oBAAkBC,CAAC,UAAO;IAC/B;EACF;EAEA,OAAOD,GAAG;AACZ"}