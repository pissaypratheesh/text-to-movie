{"version":3,"file":"GroupD8.js","names":["ux","uy","vx","vy","tempMatrices","mul","signum","x","init","i","row","push","j","_ux","_uy","_vx","_vy","k","mat","Matrix","set","GroupD8","E","SE","S","SW","W","NW","N","NE","MIRROR_VERTICAL","MIRROR_HORIZONTAL","uX","ind","uY","vX","vY","inv","rotation","add","rotationSecond","rotationFirst","sub","rotate180","isVertical","byDirection","dx","dy","Math","abs","matrixAppendRotationInv","matrix","tx","ty","append"],"sources":["../../src/math/GroupD8.js"],"sourcesContent":["import Matrix from \"./Matrix\";\n\nconst ux = [1, 1, 0, -1, -1, -1, 0, 1, 1, 1, 0, -1, -1, -1, 0, 1];\nconst uy = [0, 1, 1, 1, 0, -1, -1, -1, 0, 1, 1, 1, 0, -1, -1, -1];\nconst vx = [0, -1, -1, -1, 0, 1, 1, 1, 0, 1, 1, 1, 0, -1, -1, -1];\nconst vy = [1, 1, 0, -1, -1, -1, 0, 1, -1, -1, 0, 1, 1, 1, 0, -1];\nconst tempMatrices = [];\n\nconst mul = [];\n\nfunction signum(x) {\n  if (x < 0) {\n    return -1;\n  }\n  if (x > 0) {\n    return 1;\n  }\n\n  return 0;\n}\n\nfunction init() {\n  for (let i = 0; i < 16; i++) {\n    const row = [];\n\n    mul.push(row);\n\n    for (let j = 0; j < 16; j++) {\n      const _ux = signum(ux[i] * ux[j] + vx[i] * uy[j]);\n      const _uy = signum(uy[i] * ux[j] + vy[i] * uy[j]);\n      const _vx = signum(ux[i] * vx[j] + vx[i] * vy[j]);\n      const _vy = signum(uy[i] * vx[j] + vy[i] * vy[j]);\n\n      for (let k = 0; k < 16; k++) {\n        if (ux[k] === _ux && uy[k] === _uy && vx[k] === _vx && vy[k] === _vy) {\n          row.push(k);\n          break;\n        }\n      }\n    }\n  }\n\n  for (let i = 0; i < 16; i++) {\n    const mat = new Matrix();\n\n    mat.set(ux[i], uy[i], vx[i], vy[i], 0, 0);\n    tempMatrices.push(mat);\n  }\n}\n\ninit();\n\nconst GroupD8 = {\n  E: 0,\n  SE: 1,\n  S: 2,\n  SW: 3,\n  W: 4,\n  NW: 5,\n  N: 6,\n  NE: 7,\n  MIRROR_VERTICAL: 8,\n  MIRROR_HORIZONTAL: 12,\n  uX: ind => ux[ind],\n  uY: ind => uy[ind],\n  vX: ind => vx[ind],\n  vY: ind => vy[ind],\n  inv: rotation => {\n    if (rotation & 8) {\n      return rotation & 15;\n    }\n\n    return -rotation & 7;\n  },\n  add: (rotationSecond, rotationFirst) => mul[rotationSecond][rotationFirst],\n  sub: (rotationSecond, rotationFirst) =>\n    mul[rotationSecond][GroupD8.inv(rotationFirst)],\n\n  rotate180: rotation => rotation ^ 4,\n  isVertical: rotation => (rotation & 3) === 2,\n\n  byDirection: (dx, dy) => {\n    if (Math.abs(dx) * 2 <= Math.abs(dy)) {\n      if (dy >= 0) {\n        return GroupD8.S;\n      }\n\n      return GroupD8.N;\n    } else if (Math.abs(dy) * 2 <= Math.abs(dx)) {\n      if (dx > 0) {\n        return GroupD8.E;\n      }\n\n      return GroupD8.W;\n    } else if (dy > 0) {\n      if (dx > 0) {\n        return GroupD8.SE;\n      }\n\n      return GroupD8.SW;\n    } else if (dx > 0) {\n      return GroupD8.NE;\n    }\n\n    return GroupD8.NW;\n  },\n\n  matrixAppendRotationInv: (matrix, rotation, tx = 0, ty = 0) => {\n    // Packer used \"rotation\", we use \"inv(rotation)\"\n    const mat = tempMatrices[GroupD8.inv(rotation)];\n\n    mat.tx = tx;\n    mat.ty = ty;\n    matrix.append(mat);\n  }\n};\n\nexport default GroupD8;\n"],"mappings":"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"}