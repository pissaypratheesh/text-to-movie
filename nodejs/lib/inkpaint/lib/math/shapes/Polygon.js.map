{"version":3,"file":"Polygon.js","names":["Polygon","constructor","points","Array","isArray","Point","p","i","il","length","push","x","y","closed","type","SHAPES","POLY","clone","slice","close","contains","inside","j","xi","yi","xj","yj","intersect"],"sources":["../../../src/math/shapes/Polygon.js"],"sourcesContent":["import Point from \"../Point\";\nimport { SHAPES } from \"../../const\";\n\n/**\n * @class\n * @memberof InkPaint\n */\nexport default class Polygon {\n  constructor(...points) {\n    if (Array.isArray(points[0])) {\n      points = points[0];\n    }\n\n    // if this is an array of points, convert it to a flat array of numbers\n    if (points[0] instanceof Point) {\n      const p = [];\n\n      for (let i = 0, il = points.length; i < il; i++) {\n        p.push(points[i].x, points[i].y);\n      }\n\n      points = p;\n    }\n\n    this.closed = true;\n\n    /**\n     * An array of the points of this polygon\n     *\n     * @member {number[]}\n     */\n    this.points = points;\n\n    /**\n     * The type of the object, mainly used to avoid `instanceof` checks\n     *\n     * @member {number}\n     * @readOnly\n     * @default InkPaint.SHAPES.POLY\n     * @see InkPaint.SHAPES\n     */\n    this.type = SHAPES.POLY;\n  }\n\n  /**\n   * Creates a clone of this polygon\n   *\n   * @return {InkPaint.Polygon} a copy of the polygon\n   */\n  clone() {\n    return new Polygon(this.points.slice());\n  }\n\n  /**\n   * Closes the polygon, adding points if necessary.\n   *\n   */\n  close() {\n    const points = this.points;\n\n    // close the poly if the value is true!\n    if (\n      points[0] !== points[points.length - 2] ||\n      points[1] !== points[points.length - 1]\n    ) {\n      points.push(points[0], points[1]);\n    }\n  }\n\n  /**\n   * Checks whether the x and y coordinates passed to this function are contained within this polygon\n   *\n   * @param {number} x - The X coordinate of the point to test\n   * @param {number} y - The Y coordinate of the point to test\n   * @return {boolean} Whether the x/y coordinates are within this polygon\n   */\n  contains(x, y) {\n    let inside = false;\n\n    // use some raycasting to test hits\n    // https://github.com/substack/point-in-polygon/blob/master/index.js\n    const length = this.points.length / 2;\n\n    for (let i = 0, j = length - 1; i < length; j = i++) {\n      const xi = this.points[i * 2];\n      const yi = this.points[i * 2 + 1];\n      const xj = this.points[j * 2];\n      const yj = this.points[j * 2 + 1];\n      const intersect =\n        yi > y !== yj > y && x < (xj - xi) * ((y - yi) / (yj - yi)) + xi;\n\n      if (intersect) {\n        inside = !inside;\n      }\n    }\n\n    return inside;\n  }\n}\n"],"mappings":"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"}